!function(t){var e={};function r(i){if(e[i])return e[i].exports;var n=e[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=e,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(i,n,function(e){return t[e]}.bind(null,n));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=0)}([function(t,e,r){"use strict";r.r(e);r(1),r(5);window.onload=function(){new Vue({el:"#app",data:()=>({isMask:!1,currentProIndex:0,productList:[],productListShow:[],editProduct:{sysno:321321,sys_product_sysno:34434,sys_product_model:"TL-SDFJSK",cal_final_price:343.43,cal_refer_price:4343.34,cal_increment_price:3434.34,art_increment_price:343,art_zt_deduction_amount:34.3,art_sf_increased_amount:23.3,cal_shipment_price:34.3,cal_weight:1.2,cal_zt_ship_price:33,cal_sf_ship_price:40,art_limited_price:232,art_tmall_price:343,art_jd_price:344,isRed:!1},keywords:"",pageCount:0,pageCurrent:1,pageSize:10,skipPage:0,loading:!0,isSearch:!1}),components:{},methods:{edit(t,e){this.currentProIndex=e,this.editProduct=Object.assign({},t),this.isMask=!0},updateConfirme(){this.productList[this.currentProIndex]=Object.assign({},this.editProduct),this.isMask=!1},calculate(t){switch(t){case"all":this.productList=this.calculateProduct(this.productList);break;case"selected":this.productList=this.productList.map(t=>(t.isChecked&&(t=Object.assign({},this.calculateProduct([t])[0])),t));break;case"current":this.editProduct=Object.assign({},this.calculateProduct([this.editProduct])[0]),console.log(this.editProduct)}},displayProduct(t){"all"===t?this.isSearch?(this.getDatas(1,10),this.isSearch=!1):this.productListShow=this.productList:this.productListShow=this.productList.filter(t=>!0===t.isRed)},synchronous(t){if(window.confirm("确定要同步价格吗？")){let e=[];if("all"===t)this.calculate("all"),e=this.productList.filter(t=>1!=t.isRed);else{if(0===this.selectedProduct.length)return void alert("选中商品数为空！");this.calculate("selected"),e=this.selectedProduct.filter(t=>1!=t.isRed)}return 0!=e.length&&(axios.post("/newpricesystem/NewPriceSystem.ashx?method=sync-price",e).then(t=>{0==t.data.errorCode?alert("同步成功！"):(alert("同步失败"),console.log(t.data))}).catch(t=>{alert("同步失败"),console.log(t)}),!0)}return!1},search(){this.isSearch=!0;let t=this.keywords.split(",").map(t=>t.trim());axios.post("/newpricesystem/NewPriceSystem.ashx?method=search",t).then(t=>{this.productList=t.data.data.productData.map(t=>(t.isChecked=!1,0==t.cal_weight||0==t.cal_shipment_price?t.isRed=!0:t.isRed=!1,t)),this.productListShow=this.productList}).catch(t=>{console.log(t)})},getDatas(t){axios.post(`/newpricesystem/NewPriceSystem.ashx?method=get-data&page=${t}&limit=${this.pageSize}`).then(e=>{this.loading=!1,this.pageCurrent=t<=1?1:t,this.pageCount=Math.ceil(e.data.data.count/this.pageSize),this.productList=e.data.data.productData.map(t=>(t.isChecked=!1,0==t.cal_weight||0==t.cal_shipment_price?t.isRed=!0:t.isRed=!1,t)),this.productListShow=this.productList}).catch(t=>{console.log(t)})}},computed:{selectedProduct(){return this.productList.filter(t=>1==t.isChecked)},calculateProduct:()=>function(t){return t.map(t=>(t.art_limited_price=parseFloat(t.art_limited_price),t.art_increment_price=parseFloat(t.art_increment_price),t.cal_shipment_price=parseFloat(t.cal_shipment_price),t.cal_sf_ship_price=parseFloat(t.cal_sf_ship_price),0!=t.art_limited_price?0==t.art_increment_price?t.cal_final_price=t.art_limited_price:t.cal_final_price=t.cal_shipment_price+3.5+3+t.art_increment_price:0==t.art_increment_price?t.cal_final_price=t.cal_shipment_price+3+t.cal_sf_ship_price-t.art_sf_increased_amount:t.cal_final_price=t.cal_shipment_price+3.5+3+t.art_increment_price,0==t.art_limited_price||t.cal_final_price<t.art_limited_price||0==t.cal_weight||0==t.cal_shipment_price?t.isRed=!0:t.isRed=!1,t))}},created(){axios.post("/newpricesystem/NewPriceSystem.ashx?method=sync-data").then(t=>{this.getDatas(1)}).catch(t=>{console.log(t),alert("更新数据失败！"),this.getDatas(1)})}})}},function(t,e,r){"use strict";t.exports=r(2).polyfill()},function(t,e,r){(function(e,r){
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */var i;i=function(){"use strict";function t(t){return"function"==typeof t}var i=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},n=0,o=void 0,s=void 0,c=function(t,e){d[n]=t,d[n+1]=e,2===(n+=2)&&(s?s(_):w())},a="undefined"!=typeof window?window:void 0,u=a||{},l=u.MutationObserver||u.WebKitMutationObserver,h="undefined"==typeof self&&void 0!==e&&"[object process]"==={}.toString.call(e),p="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function f(){var t=setTimeout;return function(){return t(_,1)}}var d=new Array(1e3);function _(){for(var t=0;t<n;t+=2)(0,d[t])(d[t+1]),d[t]=void 0,d[t+1]=void 0;n=0}var m,v,y,g,w=void 0;function b(t,e){var r=this,i=new this.constructor(T);void 0===i[S]&&R(i);var n=r._state;if(n){var o=arguments[n-1];c((function(){return M(n,i,o,r._result)}))}else k(r,i,t,e);return i}function P(t){if(t&&"object"==typeof t&&t.constructor===this)return t;var e=new this(T);return x(e,t),e}h?w=function(){return e.nextTick(_)}:l?(v=0,y=new l(_),g=document.createTextNode(""),y.observe(g,{characterData:!0}),w=function(){g.data=v=++v%2}):p?((m=new MessageChannel).port1.onmessage=_,w=function(){return m.port2.postMessage(0)}):w=void 0===a?function(){try{var t=Function("return this")().require("vertx");return void 0!==(o=t.runOnLoop||t.runOnContext)?function(){o(_)}:f()}catch(t){return f()}}():f();var S=Math.random().toString(36).substring(2);function T(){}function L(e,r,i){r.constructor===e.constructor&&i===b&&r.constructor.resolve===P?function(t,e){1===e._state?A(t,e._result):2===e._state?O(t,e._result):k(e,void 0,(function(e){return x(t,e)}),(function(e){return O(t,e)}))}(e,r):void 0===i?A(e,r):t(i)?function(t,e,r){c((function(t){var i=!1,n=function(t,e,r,i){try{t.call(e,r,i)}catch(t){return t}}(r,e,(function(r){i||(i=!0,e!==r?x(t,r):A(t,r))}),(function(e){i||(i=!0,O(t,e))}),t._label);!i&&n&&(i=!0,O(t,n))}),t)}(e,r,i):A(e,r)}function x(t,e){if(t===e)O(t,new TypeError("You cannot resolve a promise with itself"));else if(n=typeof(i=e),null===i||"object"!==n&&"function"!==n)A(t,e);else{var r=void 0;try{r=e.then}catch(e){return void O(t,e)}L(t,e,r)}var i,n}function j(t){t._onerror&&t._onerror(t._result),C(t)}function A(t,e){void 0===t._state&&(t._result=e,t._state=1,0!==t._subscribers.length&&c(C,t))}function O(t,e){void 0===t._state&&(t._state=2,t._result=e,c(j,t))}function k(t,e,r,i){var n=t._subscribers,o=n.length;t._onerror=null,n[o]=e,n[o+1]=r,n[o+2]=i,0===o&&t._state&&c(C,t)}function C(t){var e=t._subscribers,r=t._state;if(0!==e.length){for(var i=void 0,n=void 0,o=t._result,s=0;s<e.length;s+=3)i=e[s],n=e[s+r],i?M(r,i,n,o):n(o);t._subscribers.length=0}}function M(e,r,i,n){var o=t(i),s=void 0,c=void 0,a=!0;if(o){try{s=i(n)}catch(t){a=!1,c=t}if(r===s)return void O(r,new TypeError("A promises callback cannot return that same promise."))}else s=n;void 0!==r._state||(o&&a?x(r,s):!1===a?O(r,c):1===e?A(r,s):2===e&&O(r,s))}var E=0;function R(t){t[S]=E++,t._state=void 0,t._result=void 0,t._subscribers=[]}var F=function(){function t(t,e){this._instanceConstructor=t,this.promise=new t(T),this.promise[S]||R(this.promise),i(e)?(this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?A(this.promise,this._result):(this.length=this.length||0,this._enumerate(e),0===this._remaining&&A(this.promise,this._result))):O(this.promise,new Error("Array Methods must be provided an Array"))}return t.prototype._enumerate=function(t){for(var e=0;void 0===this._state&&e<t.length;e++)this._eachEntry(t[e],e)},t.prototype._eachEntry=function(t,e){var r=this._instanceConstructor,i=r.resolve;if(i===P){var n=void 0,o=void 0,s=!1;try{n=t.then}catch(t){s=!0,o=t}if(n===b&&void 0!==t._state)this._settledAt(t._state,e,t._result);else if("function"!=typeof n)this._remaining--,this._result[e]=t;else if(r===D){var c=new r(T);s?O(c,o):L(c,t,n),this._willSettleAt(c,e)}else this._willSettleAt(new r((function(e){return e(t)})),e)}else this._willSettleAt(i(t),e)},t.prototype._settledAt=function(t,e,r){var i=this.promise;void 0===i._state&&(this._remaining--,2===t?O(i,r):this._result[e]=r),0===this._remaining&&A(i,this._result)},t.prototype._willSettleAt=function(t,e){var r=this;k(t,void 0,(function(t){return r._settledAt(1,e,t)}),(function(t){return r._settledAt(2,e,t)}))},t}(),D=function(){function e(t){this[S]=E++,this._result=this._state=void 0,this._subscribers=[],T!==t&&("function"!=typeof t&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof e?function(t,e){try{e((function(e){x(t,e)}),(function(e){O(t,e)}))}catch(e){O(t,e)}}(this,t):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return e.prototype.catch=function(t){return this.then(null,t)},e.prototype.finally=function(e){var r=this.constructor;return t(e)?this.then((function(t){return r.resolve(e()).then((function(){return t}))}),(function(t){return r.resolve(e()).then((function(){throw t}))})):this.then(e,e)},e}();return D.prototype.then=b,D.all=function(t){return new F(this,t).promise},D.race=function(t){var e=this;return i(t)?new e((function(r,i){for(var n=t.length,o=0;o<n;o++)e.resolve(t[o]).then(r,i)})):new e((function(t,e){return e(new TypeError("You must pass an array to race."))}))},D.resolve=P,D.reject=function(t){var e=new this(T);return O(e,t),e},D._setScheduler=function(t){s=t},D._setAsap=function(t){c=t},D._asap=c,D.polyfill=function(){var t=void 0;if(void 0!==r)t=r;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e){var i=null;try{i=Object.prototype.toString.call(e.resolve())}catch(t){}if("[object Promise]"===i&&!e.cast)return}t.Promise=D},D.Promise=D,D},t.exports=i()}).call(this,r(3),r(4))},function(t,e){var r,i,n=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function c(t){if(r===setTimeout)return setTimeout(t,0);if((r===o||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:o}catch(t){r=o}try{i="function"==typeof clearTimeout?clearTimeout:s}catch(t){i=s}}();var a,u=[],l=!1,h=-1;function p(){l&&a&&(l=!1,a.length?u=a.concat(u):h=-1,u.length&&f())}function f(){if(!l){var t=c(p);l=!0;for(var e=u.length;e;){for(a=u,u=[];++h<e;)a&&a[h].run();h=-1,e=u.length}a=null,l=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===s||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(t)}}function d(t,e){this.fun=t,this.array=e}function _(){}n.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];u.push(new d(t,e)),1!==u.length||l||c(f)},d.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=_,n.addListener=_,n.once=_,n.off=_,n.removeListener=_,n.removeAllListeners=_,n.emit=_,n.prependListener=_,n.prependOnceListener=_,n.listeners=function(t){return[]},n.binding=function(t){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(t){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},function(t,e){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(t){"object"==typeof window&&(r=window)}t.exports=r},function(t,e){}]);